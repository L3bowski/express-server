@import 'parabola';

$buttonSize: 100px;
$symbolSize: 40px;
$parabolasNumber: 50;

html {
  height: 100%;
}

body {
  margin: 0;
  min-height: 100%;
  font-family: 'Raleway', sans-serif;
  overflow: hidden;
}

.pastel-blue-bg {
  background-color: #779ECB;

  .jokify {
    background-color: #476E9B;
    color: #97BEEE;
  }

  .symbol {
    color: #476E9B;
  }
}

.pastel-green-bg {
  background-color: #77DD77;

  .jokify {
    background-color: #47AD47;
    color: #97FD97;
  }

  .symbol {
    color: #47AD47;
  }
}

.pastel-orange-bg {
  background-color: #FFB347;

  .jokify {
    background-color: #CF8317;
    color: #FFD367;
  }

  .symbol {
    color: #CF8317;
  }
}

.pastel-pink-bg {
  background-color: #DEA5A4;

  .jokify {
    background-color: #AE7574;
    color: #FEC5C4;
  }

  .symbol {
    color: #AE7574;
  }
}

.pastel-red-bg {
  background-color: #FF6961;

  .jokify {
    background-color: #CF3931;
    color: #FF8981;
  }

  .symbol {
    color: #CF3931;
  }
}

/// Working on START ////////////////////////////////

$LN2:   0.6931471805599453;
$SQRT2: 1.4142135623730951;

@function ldexp ($x, $exp) {
    $b: if($exp >= 0, 2, 1 / 2);
    @if $exp < 0 {
        $exp: $exp * -1;
    }
    @while $exp > 0 {
        @if $exp % 2 == 1 {
            $x: $x * $b;
        }
        $b: $b * $b;
        $exp: floor($exp * 0.5);
    }
    @return $x;
}

@function frexp ($x) {
    $exp: 0;
    @if $x < 0 {
        $x: $x * -1;
    }
    @if $x < 0.5 {
        @while $x < 0.5 {
            $x: $x * 2;
            $exp: $exp - 1;
        }
    } @else if $x >= 1 {
        @while $x >= 1 {
            $x: $x / 2;
            $exp: $exp + 1;
        }
    }
    @return $x, $exp;
}

@function log ($x) {
    @if $x <= 0 {
        @return 0 / 0;
    }
    $k: nth(frexp($x / $SQRT2), 2);
    $x: $x / ldexp(1, $k);
    $x: ($x - 1) / ($x + 1);
    $x2: $x * $x;
    $i: 1;
    $s: $x;
    $sp: null;
    @while $sp != $s {
        $x: $x * $x2;
        $i: $i + 2;
        $sp: $s;
        $s: $s + $x / $i;
    }
    @return $LN2 * $k + 2 * $s;
}

.joke {
  position: absolute;
  color: white;
  top: -50%;
}

@mixin free-falling-core($initial, $final) {
  $framesNumber: 60;

  $maxValue: log($framesNumber + 0.2);
  $frameWeight: 100 / $framesNumber;
  @for $i from 0 through $framesNumber {
    #{$i * $frameWeight}% {
      top: ((log($i + 0.2) / $maxValue) * $final)+%;
    }
  }
}

@keyframes free-falling {
  @include free-falling-core(-50, 50);
}

@-webkit-keyframes free-falling {
  @include free-falling-core(-50, 50);
}

.joke.animate {
  animation: free-falling 3s;
  animation-fill-mode: forwards;
  -webkit-animation: free-falling 3s;
  -webkit-animation-fill-mode: forwards;
}

/// Working on END ////////////////////////////////

.jokify {
  position: absolute;
  left: calc(50% - #{$buttonSize / 2});
  top: calc(100% - #{$buttonSize / 2});
  z-index: 2;
  height: $buttonSize;
  width: $buttonSize;
  border-radius: $buttonSize / 2;
  outline: none;
  border: none;
  font-size: 20px;

  span {
    position: relative;
    top: -1em;
  }
}

.symbol {
  position: absolute;
  left: calc(50% - #{$symbolSize / 2});
  top: calc(100% - #{$symbolSize / 2});
  font-size: $symbolSize;
}

@for $i from 1 through $parabolasNumber {
    @include random-parabola($i, -60);
}